# Nonebot Plugins for PCR

本项目主要包含为《公主连结Re:Dive!》游戏 QQ 群机器人开发的一系列插件。

## 简介

本项目依赖框架为 [Nonebot](nonebot.cqp.moe/) ，您可以使用酷 Q 机器人 Pro 版（即默认机器人能发送图片）并搭配 [CQHttp](https://cqhttp.cc) 插件，或 [Mirai](https://github.com/mamoe/mirai) + [cqhttp-mirai](https://github.com/yyuueexxiinngg/cqhttp-mirai)部署项目内所有插件。

本项目代码不堪卒读，作者是个没学习过代码规范、学业繁重且秉持“能用就行”的学生，功能也是随缘开发，大多仅考虑单群的使用而不考虑多群的兼容，不少插件是由 [HoshinoBot](https://github.com/Ice-Cirno/HoshinoBot) 这样的优秀项目移植过来，还望轻喷。感谢 Pr ，欢迎 Issue ，视心情与空闲程度处理。

本项目插件均采用 `GPL-3.0` 协议开源。下面按完成的大致时间顺序介绍插件及其功能。

### 约麻将功能

代码文件：`mahjong.py`

~~第一个插件就充满了不正经的味道~~

开发起因是群友热爱打麻将，希望能约满一定人数后收到提醒，然后就可以去麻将游戏内开局了。呼声很高的一个功能，~~然而好像一次也没开局过~~。

指令由“约麻”“取消约麻”“约麻列表”“开局”组成。数据主要保存在 `data/mahjong` 下以群号为名的文本文件中~~没错我连数据库都懒得搞~~。“开局”功能会 at 列表中的所有人，提醒其去打麻将。差不多就是这样的一个插件。

### 欢迎新成员功能

代码文件：`welcome.py`

学习 `Nonebot` 的文档时顺便写出来的，挺简单，不多说。

### 复读功能

代码文件：`repeater.py`

人类的本质都是复读机。

为了更好的效果~~与减少编码工作量~~，有不同群友发的两条相同消息则会触发机器人复读。对机器人的其它指令做了排除。不能复读带有图片的消息。

### 约合刀功能

代码文件：`together_hit.py` ~~名字好像起得不好~~

于第二次公会战面对狂暴牛时完成。~~其实就是约麻功能，把指令词换了换而已~~

### 签到功能

代码文件：`login_bonus.py`

基本是照抄 `HoshinoBot` 项目的插件，只是移植到 `Nonebot` 而已。指令为”签到“”打卡“等等，甚至叫一声”妈“也可以。仿照游戏内的每日签到，触发时送一份礼物并指定一项~~有趣的~~任务。机器人昵称为可可萝的时候比较合适，如果是别的就有点奇怪了。

### 提醒功能

代码文件：`alert.py`

向指定群定时发送特定的消息，自用场景下发送了一张提醒购买经验药水的~~生草~~图片。

注意：此插件使用前需根据实际情况修改图片路径与群号。

### 发送图片功能

代码文件：`get_picture.py`

使用 `Lolicon API` 提供的接口，产生一张美图并发送到群中。每天限量30张。

注意：此插件使用前需自行申请 API 。

### 模拟抽卡功能

代码文件夹：`gacha`

此插件大量参考了 `HoshinoBot` 项目。提供”十连“”抽一井“功能。”beta_十连“可以在返回结果中加入图片。”卡池资讯“可以查看当前 UP 。抽卡会消耗钻石，”充值“功能可以由 `SUPERUSER` 触发，为 at 的群友充值为 `JEWEL_MAX` 数量的钻石；此外，每天凌晨 5 点，所有群友的钻石数量也会重置为 `JEWEL_MAX`。可以在 `config.json` 文件中修改当前卡池信息。

注意：此插件使用前需根据实际情况修改路径~~终于肯用数据库了~~，并设置 `SUPERUSER`。”beta_十连“的图片功能，需要自行寻找角色图标，并放入 `data/gacha/icons` 文件夹中，图标命名为角色名，格式为 `PNG`。

### 切噜语翻译功能

代码文件：`cheru.py`

又是一个基本照抄 `HoshinoBot` 项目的插件，只是做了移植。指令为”切噜一下“，将后面跟随的文字按一定的编码规则转换为”切噜语“。收到切噜语时，会转化为原文。

### 作业功能

代码文件：`homework.py`

这里的”作业“指轴，此插件为公会战分享轴而编写。

注意，此插件使用前需根据实际情况修改路径，并设置 `SUPERUSER`。

## 致谢

本项目的完成离不开以下开源项目的启发与支持（排名不分先后）：

* [HoshinoBot](https://github.com/Ice-Cirno/HoshinoBot)
* [Mirai](https://github.com/mamoe/mirai)
* [cqhttp-mirai](https://github.com/yyuueexxiinngg/cqhttp-mirai)
* [Nonebot](nonebot.cqp.moe/)